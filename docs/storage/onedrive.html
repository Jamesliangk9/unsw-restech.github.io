


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xml:lang="" lang="" version="-//W3C//DTD XHTML 1.1//EN" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>One Drive &mdash; Katana User Documentation 1.0 documentation</title>
  

  

  

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'/>
    <link rel="stylesheet" href="../_static/css/pdj.css" type="text/css" />

  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Katana User Documentation 1.0 documentation" href="../index.html"/>
        <link rel="up" title="Storage" href="index.html"/>
        <link rel="next" title="Software" href="../software/index.html"/>
        <link rel="prev" title="Cloudstor" href="cloudstor.html"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="cache-control" content="public" />
    <meta name="robots" content="follow, all" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Add jQuery library -->
    <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  </head>

  <body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Katana User Documentation </a>
        <div role="search">
	  <form id ="rtd-search-form" class="wy-form"
		action="../search.html" method="get">
	    <input type="text" name="q" placeholder="Search docs" />
	    <input type="hidden" name="check_keywords" value="yes" />
	    <input type="hidden" name="area" value="default" />
	  </form>
	</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	
          
          
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../help_and_support.html">Help and Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../help_and_support.html#scheduled-maintenance">Scheduled Maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help_and_support.html#contact-the-research-technology-services-team">Contact the Research Technology Services team</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help_and_support.html#katana-system-status-and-known-issues">Katana System Status and Known Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../help_and_support.html#katana-terms-of-use">Katana Terms of Use</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using_katana/index.html">Using Katana</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using_katana/accessing_katana.html">Accessing Katana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_katana/about_katana.html">About Katana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_katana/running_jobs.html">Running Jobs on Katana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_katana/github.html">GitHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using_katana/ondemand.html">Katana OnDemand</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Storage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="storage_locations.html">Storage Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kdm.html">Katana Data Mover</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_archive.html">How to use the UNSW Data Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudstor.html">Cloudstor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">One Drive</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../software/index.html">Software</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../software/environment_modules.html">Environment Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/biosciences.html">Biosciences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/java.html">Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/jupyter-notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/intel_compilers_and_libraries.html">Intel Compilers and Software Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/operating_systems.html">Operating Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/perl.html">Perl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/python.html">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/r.html">R and RStudio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/sas.html">SAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/stata.html">Stata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/tmux.html">TMUX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software/zip.html">Compressing Large Directories</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference_data.html">Reference Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#general-faq">General FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#scheduler-faq">Scheduler FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#storage-faq">Storage FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#expanding-katana">Expanding Katana</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#acknowledging-katana">Acknowledging Katana</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

          
        

      </div>
      &nbsp;
    </nav>
    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" id="barra-mobile" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="#">Porão do Juca</a>
      </nav>

      <div class="wy-nav-content">
	<div class="fundo-claro">
	</div>
	<div class="fundo-escuro">
	</div>

        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
	    
	    <!-- <ul class="wy-breadcrumbs"> -->
	    <!--   <li><a href="#">Docs</a> &raquo;</li> -->

	    <!--   <li>Features</li> -->
	    <!--   <li class="wy-breadcrumbs-aside"> -->

	    <!-- 	<a href="_sources/index.txt" rel="nofollow"> View page source</a> -->

	    <!--   </li> -->
	    <!-- </ul> -->
	    <!-- <hr/> -->
	  </div>

          <div role="main" class="">

	    <div id="content" class="hfeed entry-container hentry">
  <div class="section" id="one-drive">
<h1>One Drive<a class="headerlink" href="#one-drive" title="Permalink to this headline">¶</a></h1>
<p>You can mount Microsoft’s <a class="reference external" href="https://onedrive.live.com/">OneDrive</a> on Katana.</p>
<div class="section" id="onedrive-background">
<h2>OneDrive Background<a class="headerlink" href="#onedrive-background" title="Permalink to this headline">¶</a></h2>
<p>We don’t really recommend researchers mount their OneDrive because the
technologies aren’t a perfect match and the configuration process is
complex.</p>
<p>But it is possible and this is our recommended process. The configuration
section will need to be run infrequently, probably only once.</p>
<p>The how-to-run section will need to be run each time.</p>
<p><a class="reference external" href="https://rclone.org/onedrive/">There are caveats to using RClone with OneDrive</a> that users will need to be
aware of and which the UNSW team cannot help with.</p>
<p>And there is one local caveat that needs to be understood:</p>
<p>Mounting OneDrive locally will only work on the machine on which the <cite>mount</cite>
command is run.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In practice, this has implications. All of our other common
drives, like /apps, /home and /srv/scratch, will automatically mount on all
machines. OneDrive only mounts on the machine you mount it on. If you mount
it on the login node katana1, it will not be available on katana2 or any of
the worker nodes. You will need to mount OneDrive within your PBS script.</p>
</div>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><a class="reference external" href="https://consenthelper.it.unsw.edu.au/consent?appId=c8800f43-7805-46c2-b8b2-1c55f3859a4c">OneDrive needs your consent</a> to give rclone access to your files.</li>
</ol>
<p>2. We can’t guarantee or test if this works for researchers in Germany or
China. OneDrive has a different set up for Germany and China due to local laws
about data storage.</p>
<p>3. You will need to install rclone in your home directory on katana as the
version in the CentOS/RHEL operating system is too old.</p>
<ol class="arabic simple" start="4">
<li>You will need at least one empty directory for mounting. Restech recommends:</li>
</ol>
<ul class="simple">
<li>you create a directory /home/z1234567/bin to put rclone into</li>
<li>you add /home/z1234567/bin to your PATH</li>
<li>you create a directory /home/z1234567/OneDrive to mount OneDrive onto.</li>
</ul>
<ol class="arabic simple" start="5">
<li>You will need to ask us for the secret key. Please don’t write it down.</li>
</ol>
</div>
<div class="section" id="install-rclone">
<h2>Install RClone<a class="headerlink" href="#install-rclone" title="Permalink to this headline">¶</a></h2>
<p>1. Go to this page and copy the link to the latest version for
<cite>Intel/AMD - 64 Bit Linux</cite>. Currently that looks like this:</p>
<p><a class="reference external" href="https://downloads.rclone.org/v1.55.0/rclone-v1.55.0-linux-amd64.zip">https://downloads.rclone.org/v1.55.0/rclone-v1.55.0-linux-amd64.zip</a></p>
<ol class="arabic simple" start="2">
<li>On Katana, unzip</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>z1234567@katana1 ~<span class="o">]</span>$ wget https://downloads.rclone.org/v1.55.0/rclone-v1.55.0-linux-amd64.zip
<span class="o">[</span>z1234567@katana1 ~<span class="o">]</span>$ unzip rclone-v1.55.0-linux-amd64.zip
        Archive:  rclone-v1.55.0-linux-amd64.zip
                creating: rclone-v1.55.0-linux-amd64/
                inflating: rclone-v1.55.0-linux-amd64/rclone.1
                inflating: rclone-v1.55.0-linux-amd64/README.txt
                inflating: rclone-v1.55.0-linux-amd64/git-log.txt
                inflating: rclone-v1.55.0-linux-amd64/rclone
                inflating: rclone-v1.55.0-linux-amd64/README.html
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Install into a local directory</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>z1234567@katana1 ~<span class="o">]</span>$ cp rclone-v1.55.0-linux-amd64/rclone ~/bin/
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Give OneDrive consent to allow rclone access to your files</li>
</ol>
</div>
<div class="section" id="configure-rclone-for-onedrive">
<h2>Configure RClone for OneDrive<a class="headerlink" href="#configure-rclone-for-onedrive" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Login to Katana and run:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>z1234567@katana1 ~<span class="o">]</span>$ rclone config
</pre></div>
</div>
<p>You will be asked a set of questions. The short answers are:</p>
<ol class="arabic simple">
<li>new remote (‘n’)</li>
<li>name (‘OneDrive’)</li>
<li>storage type <strong>Microsoft OneDrive</strong> (‘26’ in rclone version 1.55)</li>
<li>OAuth Client Id (“c8800f43-7805-46c2-b8b2-1c55f3859a4c”)</li>
<li>OAuth Client Secret (This is actually a secret. You will need to ask ResTech)</li>
<li>Choose national cloud region for OneDrive (“1. global”)</li>
<li>Edit advanced config? (“n”)</li>
<li>Remote config? (“n”)</li>
<li>Paste result:</li>
<li>Choose a number from below, or type in an existing value (“1. OneDrive Personal or Business”)</li>
<li>Chose drive to use: (“0”)</li>
<li>Is that okay? (“Y”)</li>
</ol>
<p>You should then see something like this to which you should answer yes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--------------------
 <span class="o">[</span>MS OneDrive<span class="o">]</span>
 <span class="nb">type</span> <span class="o">=</span> onedrive
 <span class="nv">client_id</span> <span class="o">=</span> c8800f43-7805-46c2-b8b2-1c55f3859a4c
 <span class="nv">client_secret</span> <span class="o">=</span> SECRET
 <span class="nv">region</span> <span class="o">=</span> global
 <span class="nv">token</span> <span class="o">=</span> <span class="o">{</span><span class="s2">&quot;access_token&quot;</span>:<span class="s2">&quot;eyJ0e...asdasd&quot;</span><span class="o">}</span>
 <span class="nv">drive_type</span> <span class="o">=</span> business
 --------------------
 y<span class="o">)</span> Yes this is OK <span class="o">(</span>default<span class="o">)</span>
 e<span class="o">)</span> Edit this remote
 d<span class="o">)</span> Delete this remote
 y/e/d&gt;
</pre></div>
</div>
</div>
<div class="section" id="how-to-mount-onedrive">
<h2>How to mount OneDrive<a class="headerlink" href="#how-to-mount-onedrive" title="Permalink to this headline">¶</a></h2>
<p>Once logged in or in a pbs script:</p>
<ol class="arabic simple">
<li>Mount the drive. The basic syntax is:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rclone mount &lt;remote-name&gt;: /path/to/local/mount
</pre></div>
</div>
<p>We need to add a couple of flags to make this warning free and usable. Most
notably <cite>–daemon</cite> and <cite>–vfs-cache-mode writes</cite>.</p>
<p>If you have followed the Restech recommendations, your command will look like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>z1234567@katana1 ~<span class="o">]</span>$ rclone mount OneDrive: /home/z1234567/OneDrive --daemon --vfs-cache-mode writes
</pre></div>
</div>
</div>
<div class="section" id="final-notes">
<h2>Final Notes<a class="headerlink" href="#final-notes" title="Permalink to this headline">¶</a></h2>
<p>ResTech really only recommends this if you have sensitive data.</p>
<p>If your data is relatively large - anything above 1GB - we recommend you follow
our standard procedure for large datasets:</p>
<ol class="arabic simple">
<li>copy data from source (OneDrive) closer to the cpus ($PBS_TMPDIR)</li>
<li>&lt;do analysis&gt;</li>
<li>write results to local drive ($PBS_TMPDIR)</li>
<li>copy results from local drive to OneDrive</li>
<li>delete local data and results</li>
</ol>
<p><cite>$PBS_TMPDIR</cite> is only visible to the PBS job that is running. This is as secure
as possible.</p>
</div>
</div>


	    </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../software/index.html" class="btn btn-neutral float-right" title="Software">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cloudstor.html" class="btn btn-neutral" title="Cloudstor"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/jucacrispim/sphinx_pdj_theme">theme</a> provided by <a href="http://poraodojuca.net">Porão do Juca</a>.

</footer>
	</div>
	</div>
	  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
    <script type="text/javascript" src="../_static/jquery.js">

    </script>
    <script type="text/javascript" src="../_static/underscore.js">

    </script>
    <script type="text/javascript" src="../_static/doctools.js">

    </script>
    <script type="text/javascript" src="../_static/language_data.js">

    </script>

  

   <script type="text/javascript"
           src="../_static/js/theme.js"></script>

   <script type="text/javascript"
           src="../_static/js/pdj.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  </body>
</html>